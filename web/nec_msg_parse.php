<?php
    include('../tpl/header.php');
    include('../lib/html_common.inc');
    include('../lib/misc.inc');
    
    # 依斷行區分NEC電文
    // $nec_msg = '20160509201605090000102016050923595900811100331762500000000004640001842070012469005725000696557002408056000012663000006454000012288000016517000000223000000044000000000000000000000000000000000000';
    $nec_msg = '20161101201611010000002016110123595900788900319678800000000004100001716620012293005801000333851002649853000006069000007102000013022000025920000000237000000069000000400000002080000000007000000006';
    $nec_msg = str_replace("\r", '', $nec_msg);
    $nec_msg_list = explode("\n", $nec_msg);
    
    foreach ($nec_msg_list as $m_idx => $t_msg) {
        if ($m_idx == 0) {
            # Header 解析長度
            $cut_len_list = array(8,8,6,8,6,6,9,7,6,9,7,6,9,9,9,9,9,9,9,9,9,9,9,9);
        } else {
            # Body 解析長度
            $cut_len_list = array(12,9,1,1,10,6,1,10,6,1,1,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,1,1,5,2,5,16,1,3,1,3,1,3,1,3);
        }
        
        $s_idx = 0;
        foreach ($cut_len_list as $t_len) {                
            $t_str = substr($t_msg, $s_idx , $t_len);
            disp($t_str);
            $s_idx += $t_len;
        }
        disp('');
    }
    
    include('../tpl/footer.php');
?>