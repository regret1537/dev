<?php
    include('../tpl/header.php');
    include('../lib/html_common.inc');
    include('../lib/misc.inc');
    
    # 依斷行區分中信電文                                                                                                                                       ';
    $ctbc_file = '81607150130000779000000020000000302000000000000000000Y歐付寶－歐付寶                        00                                                                                                        
1160714222300******9668000400053830000000101歐付寶－歐付寶         7026002528                    01020203                                                                                             
1160714222300******9676000400053840000000201歐付寶－歐付寶         7026002528                    01020203                                                                                             
';
    $ctbc_file = '81608010130004079000000290000017676000000010000000200Yｒａｉｌｗａｙ                        00                                                                                                        
11607304563186320378464000403321010000000294ｒａｉｌｗａｙ         50                                                                                                                                 
11607304611588865810706000408988980000000237ｒａｉｌｗａｙ         50                                                                                                                                 
11607305241084500780905000408544550000000395ｒａｉｌｗａｙ         50                            2                                                                                                    
11607304311780242403189000407911870000000066ｒａｉｌｗａｙ         50                                                                                                                                 
11607304563198505896921000400803650000000880ｒａｉｌｗａｙ         50                                                                                                                                 
11607304392375636000832000400071610000000940ｒａｉｌｗａｙ         50                                                                                                                                 
11607304649612349000332000405389070000000254ｒａｉｌｗａｙ         50                                                                                                                                 
11607304029874500764003000409344600000000181ｒａｉｌｗａｙ         50                                                                                                                                 
11607304870238006060094000406977630000001624ｒａｉｌｗａｙ         50                                                                                                                                 
11607233567338003269100000419307660000000200ｒａｉｌｗａｙ         50                                                                                                                                 
11607314423522800006441000400797290000000342ｒａｉｌｗａｙ         50                                                                                                                                 
11607305211298804004665000404391580000000698ｒａｉｌｗａｙ         50                            2                                                                                                    
11607314147636605867701000401273710000000265ｒａｉｌｗａｙ         50                                                                                                                                 
11607314423555900090451000400797330000000892ｒａｉｌｗａｙ         50                                                                                                                                 
11607315520036002561904000401273810000000115ｒａｉｌｗａｙ         50                            2                                                                                                    
11607313567150216763104000408324080000000262ｒａｉｌｗａｙ         50                                                                                                                                 
11607315520491008425663000400804840000000686ｒａｉｌｗａｙ         50                            2                                                                                                    
11607314147633700576501000401274140000000738ｒａｉｌｗａｙ         50                                                                                                                                 
11607315241085608933205000406328750000000426ｒａｉｌｗａｙ         50                            2                                                                                                    
11607304574110016685609000400578100000000342ｒａｉｌｗａｙ         50                                                                                                                                 
11607314147630700700909000401274270000000880ｒａｉｌｗａｙ         50                                                                                                                                 
11607314563188431292600000408106210000000826ｒａｉｌｗａｙ         50                                                                                                                                 
11607315520030304786202000401274310000001754ｒａｉｌｗａｙ         50                            2                                                                                                    
11607314563130055708602000401194810000000286ｒａｉｌｗａｙ         50                                                                                                                                 
11607314065790009598707000401718590000000669ｒａｉｌｗａｙ         60                                                                                                                                 
11607314514459500039309000400951420000000237ｒａｉｌｗａｙ         50                                                                                                                                 
11607315466005401276402000409347430000000440ｒａｉｌｗａｙ         50                            2                                                                                                    
11607315149147700761505000401274840000001958ｒａｉｌｗａｙ         50                            2                                                                                                    
11607315239767149000628000407482380000000429ｒａｉｌｗａｙ         50                            2                                                                                                    
11607314311951049253719000400805880000000560ｒａｉｌｗａｙ         50                                                                                                                                 
';
    $ctbc_file = str_replace("\r", '', $ctbc_file);
    $ctbc_msg_list = explode("\n", $ctbc_file);
    
    foreach ($ctbc_msg_list as $m_idx => $t_msg) {
        $t_first_chr = substr($t_msg, 0, 1);
        switch ($t_first_chr) {
            case '8':
                # HEADER 解析長度
                // $cut_len_list = array(1,6,9,1,8,10,8,10,1,40,1,1,4,60);# 半形
                // $cut_len_list = array(1,6,9,1,8,10,8,10,1,38,1,1,4,60);# 全形
                // $cut_len_list = array(1,6,9,1,8,10,8,10,1,46,1,1,4,60);# 全形(ＡＬＬＰＡＹ)
                $cut_len_list = array(1,6,9,1,8,10,8,10,1,47,1,1,4,60);# 全形(歐付寶－歐付寶, ｒａｉｌｗａｙ)
                // $cut_len_list = array(1,6,9,1,8,10,8,10,1,50,1,1,4,60);# 全形(ｃｈｉｃｈｅｎ﹒ｃｏ)
                break;
            case '1':
                # DETAIL 解析長度
                // $cut_len_list = array(1,6,16,3,2,6,10,25,1,1,8,20,1,15,40,5);# 半形
                // $cut_len_list = array(1,6,16,3,2,6,10,23,1,1,8,20,1,15,40,5);# 全形
                // $cut_len_list = array(1,6,16,3,2,6,10,26,1,1,8,20,1,15,38,5);# 全形(歐付寶)
                // $cut_len_list = array(1,6,16,3,2,6,10,29,1,1,8,20,1,15,38,5);# 全形(ＡＬＬＰＡＹ)
                $cut_len_list = array(1,6,16,3,2,6,10,30,1,1,8,20,1,15,38,5);# 全形(歐付寶－歐付寶, , ｒａｉｌｗａｙ)
                // $cut_len_list = array(1,6,16,3,2,6,10,33,1,1,8,20,1,15,38,5);# 全形(ｃｈｉｃｈｅｎ﹒ｃｏ)
                break;
            case '9':
                # TRAILER 解析長度
                $cut_len_list = array(1,6,8,145);
        }
        
        $s_idx = 0;
        foreach ($cut_len_list as $t_len) {                
            $t_str = substr($t_msg, $s_idx , $t_len);
            disp(str_replace(' ', '@',$t_str));
            $s_idx += $t_len;
        }
        disp('');
    }
    
    include('../tpl/footer.php');
?>